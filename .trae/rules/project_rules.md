# 项目规则

## 项目概述

本项目是 **Timeline Craft AI**，一个智能视频创作工具。它允许用户使用基于时间轴的编辑器从文本描述创建视频内容。

该应用程序使用现代前端技术栈构建：

- **框架：** React
- **语言：** TypeScript
- **构建工具：** Vite
- **UI：** shadcn/ui 组件
- **样式：** Tailwind CSS
- **代码检查：** ESLint
- **代码格式化：** Prettier

核心功能包括用于管理视频片段的时间轴、AI 驱动的视频帧图像生成和自动化视频合成。

## 构建和运行

### 开发环境

在本地开发环境中运行应用程序：

1. **安装依赖：**

   ```bash
   pnpm install
   ```

2. **启动开发服务器：**

   ```bash
   pnpm run dev
   ```

### 生产构建

创建生产就绪的应用程序构建：

```bash
pnpm run build
```

### 代码检查

检查代码的 linting 错误：

```bash
pnpm run lint
```

## 开发流程

进行任何修改时，必须遵循以下流程：

- 进行任何修改后，必须等待用户反馈以确认问题是否已解决，而不是立即假设问题已修复。
- 随时更新 [PRD文档](PRD.md) 以反映最新的功能和变更。

## 开发规范

- **代码风格：** 项目使用 Prettier 进行自动代码格式化。
- **代码检查：** ESLint 配置用于强制执行代码质量并捕获潜在错误。
- **Git 钩子：** 使用 Husky 运行预提交钩子，确保代码在提交前经过格式化和检查。

---

## 开发者技术指南

### 项目结构

`src` 目录的组织结构如下：

- `components/`：包含所有 React 组件。
  - `ui/`：来自 `shadcn/ui` 的可重用、通用 UI 组件。这些应该是无状态的，专注于展示。
  - `studio/`：特定于视频编辑工作室界面的组件，可能包含业务逻辑。
- `hooks/`：用于共享逻辑的自定义 React 钩子（例如，`use-mobile` 用于响应式检查）。
- `lib/`：实用函数和库（例如，`utils.ts` 用于辅助函数）。
- `pages/`：映射到路由的顶级页面组件。
- `App.tsx`：定义路由的主应用程序组件。
- `main.tsx`：应用程序的入口点。

### 添加新组件

#### UI 组件 (shadcn/ui)

本项目使用 `shadcn/ui` 作为组件库。要从库中添加新组件：

1. **使用 CLI：** 运行以下命令并选择您需要的组件：

   ```bash
   npx shadcn-ui@latest add [component-name]
   ```

   这将把组件的源文件添加到 `src/components/ui`。

2. **导入和使用：** 从 `src/components/ui` 中的文件导入新组件并在代码中使用。

#### 自定义组件

对于新功能，在最相关的目录中创建自定义组件（例如，`src/components/studio` 用于编辑器相关功能）。

- **文件命名：** 组件文件名使用 PascalCase（例如，`MyNewComponent.tsx`）。
- **结构：** 保持组件专注于单一职责。如果组件变得过于复杂，将其分解为更小、更易管理的组件。
- **样式：** 使用 Tailwind CSS 类进行样式设置。除非绝对必要，否则避免编写单独的 CSS 文件。

### 状态管理

应用程序使用 **TanStack Query (React Query)** 来管理服务器状态（从 API 获取、缓存和更新数据）。

- **使用：** 获取数据时，使用 `useQuery` 钩子。对于变更操作（创建、更新、删除数据），使用 `useMutation`。
- **位置：** API 相关的钩子应该与使用它们的功能放在一起，或者如果应用程序规模扩大，可以放在专门的 `src/queries` 目录中。

对于需要在多个组件之间共享的客户端状态，使用 React Context 或者如果复杂性增长，使用专门的状态管理库。

### 路由

路由由 **React Router** 处理。

- **配置：** 路由在 `src/App.tsx` 中定义。
- **添加新页面：**
  1. 在 `src/pages` 中创建新的页面组件（例如，`About.tsx`）。
  2. 在 `App.tsx` 中导入新页面并添加新的 `<Route>` 条目。

### 故障排除

- **依赖问题：** 如果在拉取新更改后遇到问题，运行 `pnpm install` 以确保所有依赖项都是最新的。
- **Linting/格式化错误：** 运行 `pnpm run lint` 和 `pnpm run format` 来自动修复许多常见错误。预提交钩子应该防止这些被提交，但手动运行它们是一个好习惯。
- **构建失败：** 检查 `pnpm run build` 的控制台输出以获取具体错误。通常，这些与 TypeScript 类型错误或不正确的导入路径有关。
